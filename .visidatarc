from datetime import datetime
import time
import maya

options.clipboard_copy_cmd = "pbcopy"

def to_timestamp(str):
  ts = datetime.strptime(str, "%Y-%m-%d")
  return time.mktime(ts.timetuple())

def to_datetime(str, tz=None):
  return datetime.fromtimestamp(str, tz=tz)

def maya_to_datetime(str):
  return maya.parse(str).datetime()

def count_distinct_string(values):
  'Counts distinct values of string, optionally splitting by a separator'
  separator = input("separator (optional):", "count_distinct_sep")
  distincts = set()
  for value in values:
    if separator != None and len(separator) > 0:
        for split_value in value.split(separator):
            distincts.add(split_value)
    else:
      distincts.add(value)
  return len(distincts)

aggregator('str_count_distinct', count_distinct_string)
